<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meanbook Rental - Board Game Catalog</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root { --bg-dark: #050505; --accent: #ffffff; --glass: rgba(255, 255, 255, 0.03); }
        body { font-family: 'Inter', 'Kanit', sans-serif; background-color: var(--bg-dark); color: #ffffff; scroll-behavior: smooth; }
        
        .glass-card { 
            background: var(--glass); 
            backdrop-filter: blur(16px); 
            border: 1px solid rgba(255, 255, 255, 0.08); 
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); 
            border-radius: 1.5rem; 
        }
        
        .glass-card:hover { 
            border-color: rgba(255, 255, 255, 0.3); 
            transform: translateY(-10px); 
            background: rgba(255, 255, 255, 0.05); 
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.5); 
        }
        
        .status-available { color: #4ade80; background: rgba(74, 222, 128, 0.15); border: 1px solid rgba(74, 222, 128, 0.3); }
        .status-unavailable { color: #f87171; background: rgba(248, 113, 113, 0.15); border: 1px solid rgba(248, 113, 113, 0.3); }
        .status-pending { color: #a1a1aa; background: rgba(161, 161, 170, 0.15); border: 1px solid rgba(161, 161, 170, 0.3); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.8s ease-out forwards; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #222; border-radius: 10px; }

        .banner-image {
            width: 100%;
            height: auto;
            margin: 0;
            display: block;
            background: #111;
        }

        select option {
            background-color: #1a1a1a;
            color: #ffffff;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-[100] border-b border-white/5 bg-black/80 backdrop-blur-xl">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <div class="flex items-center gap-4 group cursor-pointer" onclick="window.scrollTo(0,0)">
                <div class="w-11 h-11 bg-white rounded-xl flex items-center justify-center shadow-lg transition-transform group-hover:scale-105">
                    <i data-lucide="dices" class="text-black w-6 h-6"></i>
                </div>
                <div class="flex flex-col">
                    <span class="text-xl font-black tracking-tighter uppercase leading-none">Meanbook</span>
                    <span class="text-[10px] text-zinc-500 uppercase tracking-[0.3em] font-bold">Rental Experience</span>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <a href="https://line.me/ti/p/@meanbook" target="_blank" class="bg-white/5 hover:bg-white/10 text-white px-5 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest border border-white/10 flex items-center gap-2 transition-all">
                    <i data-lucide="message-circle" class="w-3 h-3 text-green-400"></i> Line OA
                </a>
            </div>
        </div>
    </nav>

    <!-- Header Banner -->
    <section class="pt-20 pb-0 relative overflow-hidden">
        <div class="fade-in w-full">
            <img id="mainBanner" src="" alt="Meanbook Rental Banner" class="banner-image opacity-0 transition-opacity duration-500">
        </div>
    </section>

    <!-- Main Content -->
    <main class="max-w-[1600px] mx-auto px-6 pt-12 pb-20 flex-grow w-full">
        <!-- Search Controls -->
        <section id="games" class="mb-20">
            <div class="flex flex-col md:flex-row gap-6 mb-12">
                <div class="relative flex-1">
                    <i data-lucide="search" class="absolute left-6 top-1/2 -translate-y-1/2 text-zinc-600 w-5 h-5"></i>
                    <input type="text" id="searchInput" placeholder="ค้นหาชื่อเกม..." class="w-full bg-zinc-900/40 border border-white/10 rounded-2xl py-6 pl-16 pr-8 focus:outline-none focus:border-white/30 transition-all text-white text-lg">
                </div>
                <select id="statusFilter" class="bg-zinc-900 border border-white/10 rounded-2xl px-8 focus:outline-none text-sm font-bold tracking-widest text-white appearance-none cursor-pointer min-w-[200px]">
                    <option value="all">สถานะทั้งหมด</option>
                    <option value="ว่าง">ว่าง</option>
                    <option value="ติดเช่า">ติดเช่า</option>
                    <option value="กำลังดำเนินการ">กำลังดำเนินการ</option>
                </select>
            </div>

            <!-- Loader -->
            <div id="loading" class="flex flex-col items-center justify-center py-40">
                <div class="w-12 h-12 border-2 border-zinc-800 border-t-white rounded-full animate-spin mb-6"></div>
                <p id="loadingText" class="text-zinc-600 font-bold uppercase tracking-widest text-[10px]">Syncing Inventory...</p>
            </div>

            <!-- Grid Display -->
            <div id="gamesGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-10"></div>
            <div id="noResults" class="hidden text-center py-40"><p class="text-zinc-500 text-xl font-light">ไม่พบเกมที่คุณค้นหาครับ คุณเม </p></div>

            <!-- Pagination Controls -->
            <div id="paginationControls" class="flex justify-center items-center gap-4 mt-16"></div>
        </section>
    </main>

    <!-- Footer Section -->
    <footer class="border-t border-white/10 bg-black/60 pt-16 pb-8 mt-auto">
        <div class="max-w-[1600px] mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between gap-12 mb-12">
                
                <!-- Brand Info -->
                <div class="flex flex-col gap-4 max-w-sm">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-white rounded-xl flex items-center justify-center shadow-lg">
                            <i data-lucide="dices" class="text-black w-6 h-6"></i>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-xl font-black tracking-tighter uppercase leading-none text-white">Meanbook</span>
                            <span class="text-[10px] text-zinc-500 uppercase tracking-[0.3em] font-bold">Rental Experience</span>
                        </div>
                    </div>
                    <p class="text-zinc-500 text-sm leading-relaxed mt-2">
                        บริการเช่าบอร์ดเกมจาก MEANBOOK ที่พร้อมให้คุณเช่าบอร์ดเกมไปเล่นที่บ้านได้
                    </p>
                </div>

                <!-- Contact Info -->
                <div class="flex flex-col gap-4 md:items-end">
                    <h4 class="text-white font-bold uppercase tracking-widest text-xs mb-2">ติดต่อสอบถาม</h4>
                    <a href="https://line.me/ti/p/@meanbook" target="_blank" class="text-zinc-500 hover:text-green-400 text-sm transition-colors flex items-center gap-3 w-fit">
                        <i data-lucide="message-circle" class="w-4 h-4 shrink-0"></i> Line OA: @meanbook
                    </a>
                    <p class="text-zinc-500 text-sm flex items-center gap-3 w-fit">
                        <i data-lucide="phone" class="w-4 h-4 shrink-0"></i> 064-186-9998
                    </p>
                    <p class="text-zinc-500 text-sm flex items-start gap-3 w-fit md:text-right">
                        <i data-lucide="map-pin" class="w-4 h-4 mt-0.5 shrink-0"></i> 
                        <span class="max-w-[250px] md:max-w-xs">110/15 ม.2 ต.ปากเกร็ด อ.ปากเกร็ด จ.นนทบุรี 11120</span>
                    </p>
                </div>
            </div>

            <!-- Copyright -->
            <div class="pt-8 border-t border-white/5 flex justify-center items-center">
                <p class="text-zinc-600 text-xs tracking-widest uppercase text-center">Copyright © 2026 Meanbook. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSboMt8lu6Md3_4KGIZ3QoBCeCO-3RGCg0TVnD4B-zy4TOjQrFExssmO34xciDHLCFUCBhQC3Wixto3/pub?gid=0&single=true&output=csv';
        const CONTACT_LINK = 'https://line.me/ti/p/@meanbook';
        const ASSETS_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSboMt8lu6Md3_4KGIZ3QoBCeCO-3RGCg0TVnD4B-zy4TOjQrFExssmO34xciDHLCFUCBhQC3Wixto3/pub?gid=283486066&single=true&output=csv'; 
        
        const mockData = [
            { name: "28 Days (ไทย)", type: "https://boardgamegeek.com/boardgame/344073/28-days", lang: "ไทย", manual: "มี", status: "ว่าง", price: "100", deposit: "500", value: "850", img: "https://images.unsplash.com/photo-1610812382607-4f6593450cc7?q=80&w=800" },
            { name: "Sheriff of Nottingham", type: "Party Game", lang: "ไทย", manual: "มี", status: "ติดเช่า", price: "150", deposit: "1000", value: "1550", img: "https://images.unsplash.com/photo-1611996575749-79a3a250f948?q=80&w=800" },
            { name: "3 Chapters", type: "Family", lang: "ไทย", manual: "ไม่มี", status: "กำลังดำเนินการ", price: "50", deposit: "300", value: "590", img: "https://images.unsplash.com/photo-1553481199-462d225edec4?q=80&w=800" }
        ];

        let allGames = [];
        let filteredGames = [];
        let gameLogoUrl = ''; 
        
        const ITEMS_PER_PAGE = 20; 
        let currentPage = 1;
        let isShowAll = false; 

        function formatDriveImageUrl(url) {
            if (!url) return '';
            const driveUrl = url.replace(/"/g, '').trim();
            if (driveUrl.includes('drive.google.com')) {
                let fileId = '';
                if (driveUrl.includes('/file/d/')) {
                    fileId = driveUrl.split('/file/d/')[1].split('/')[0];
                } else if (driveUrl.includes('id=')) {
                    fileId = driveUrl.split('id=')[1].split('&')[0];
                }
                if (fileId) return `https://lh3.googleusercontent.com/u/0/d/${fileId}`;
            }
            return driveUrl;
        }

        async function init() {
            try {
                const assetResponse = await fetch(ASSETS_SHEET_URL);
                if (assetResponse.ok) {
                    const assetData = await assetResponse.text();
                    const assetRows = assetData.split('\n');
                    assetRows.forEach(row => {
                        const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                        const key = cols[0]?.replace(/"/g, '').trim();
                        const value = cols[1]?.replace(/"/g, '').trim();
                        if (key === 'Banner') {
                            const bannerImg = document.getElementById('mainBanner');
                            bannerImg.src = formatDriveImageUrl(value);
                            bannerImg.onload = () => bannerImg.classList.remove('opacity-0');
                            bannerImg.onerror = () => loadDefaultBanner();
                        }
                        if (key === 'BGG Logo') {
                            gameLogoUrl = formatDriveImageUrl(value);
                        }
                    });
                } else { loadDefaultBanner(); }
            } catch (e) { loadDefaultBanner(); }

            try {
                const response = await fetch(SHEET_URL);
                if (!response.ok) throw new Error('Local connection blocked');
                const data = await response.text();
                const rows = data.split('\n');
                allGames = rows.slice(1).map(row => {
                    const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                    return {
                        name: cols[2]?.replace(/"/g, '').trim(),
                        img: formatDriveImageUrl(cols[3]),
                        type: cols[4]?.replace(/"/g, '').trim() || '', 
                        lang: cols[7]?.replace(/"/g, '').trim() || '-',
                        manual: cols[8]?.replace(/"/g, '').trim() || 'ไม่มี',
                        price: cols[9]?.replace(/"/g, '').trim(),
                        value: cols[10]?.replace(/"/g, '').trim(),
                        deposit: cols[11]?.replace(/"/g, '').trim(),
                        status: cols[14]?.replace(/"/g, '').trim()
                    };
                }).filter(game => game.name);
                filteredGames = [...allGames];
                renderPaginated();
                document.getElementById('loading').style.display = 'none';
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                allGames = mockData;
                filteredGames = [...allGames];
                renderPaginated();
            }
        }

        function loadDefaultBanner() {
            const bannerImg = document.getElementById('mainBanner');
            bannerImg.src = 'banner.png';
            bannerImg.onload = () => bannerImg.classList.remove('opacity-0');
            bannerImg.onerror = () => {
                bannerImg.src = 'https://via.placeholder.com/1200x500/111/fff?text=Meanbook+Rental+Banner';
                bannerImg.classList.remove('opacity-0');
            };
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusTerm = document.getElementById('statusFilter').value;
            
            filteredGames = allGames.filter(g => {
                const matchSearch = g.name.toLowerCase().includes(searchTerm);
                const gameStatus = (g.status || '').trim();
                const matchStatus = statusTerm === 'all' || gameStatus === statusTerm;
                return matchSearch && matchStatus;
            });
            
            currentPage = 1; 
            isShowAll = false; 
            renderPaginated();
        }

        function changePage(delta) {
            currentPage += delta;
            renderPaginated();
            document.getElementById('games').scrollIntoView({ behavior: 'smooth' });
        }

        function toggleShowAll() {
            isShowAll = !isShowAll;
            if (!isShowAll) currentPage = 1; 
            renderPaginated();
            document.getElementById('games').scrollIntoView({ behavior: 'smooth' });
        }

        function renderPaginated() {
            const grid = document.getElementById('gamesGrid');
            const noResults = document.getElementById('noResults');
            const paginationContainer = document.getElementById('paginationControls');
            
            if (filteredGames.length === 0) {
                grid.innerHTML = '';
                noResults.classList.remove('hidden');
                paginationContainer.innerHTML = '';
                return;
            }
            noResults.classList.add('hidden');

            const totalPages = Math.ceil(filteredGames.length / ITEMS_PER_PAGE);
            let gamesToShow = [];

            if (isShowAll) {
                gamesToShow = filteredGames;
            } else {
                if (currentPage > totalPages) currentPage = totalPages;
                if (currentPage < 1) currentPage = 1;

                const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
                const endIndex = startIndex + ITEMS_PER_PAGE;
                gamesToShow = filteredGames.slice(startIndex, endIndex);
            }

            grid.innerHTML = gamesToShow.map(game => {
                const statusStr = (game.status || '').trim();
                const isAvailable = statusStr === 'ว่าง';
                
                const finalLink = `${CONTACT_LINK}${CONTACT_LINK.includes('?') ? '&' : '?'}text=${encodeURIComponent('สนใจเช่า: ' + game.name)}`;
                
                let typeDisplay = '';
                if (game.type && game.type.toLowerCase().startsWith('http')) {
                    if (gameLogoUrl) {
                        typeDisplay = `<a href="${game.type}" target="_blank" class="transition-all hover:scale-105 inline-block"><img src="${gameLogoUrl}" class="h-10 object-contain opacity-90 hover:opacity-100 transition-opacity" alt="BGG Link"></a>`;
                    } else {
                        typeDisplay = `<a href="${game.type}" target="_blank" class="text-[12px] text-zinc-500 hover:text-white underline truncate max-w-[150px] inline-block font-bold">BGG Link</a>`;
                    }
                }

                let buttonStyles = '';
                if (statusStr === 'ว่าง') {
                    // เพิ่ม transition-transform hover:scale-105 เพื่อให้ปุ่มขยายตัวเมื่อชี้เมาส์
                    buttonStyles = 'bg-green-500 text-black hover:bg-green-400 shadow-lg shadow-green-500/20 transition-transform hover:scale-105 active:scale-95';
                } else if (statusStr === 'ติดเช่า') {
                    buttonStyles = 'bg-red-600 text-white cursor-not-allowed pointer-events-none opacity-90 shadow-lg shadow-red-900/20';
                } else if (statusStr === 'กำลังดำเนินการ') {
                    buttonStyles = 'bg-zinc-500 text-white cursor-not-allowed pointer-events-none opacity-90 shadow-lg shadow-zinc-500/20';
                } else {
                    buttonStyles = 'bg-zinc-800 text-zinc-400 cursor-not-allowed pointer-events-none';
                }

                return `
                <div class="glass-card overflow-hidden group flex flex-col">
                    <div class="aspect-square relative overflow-hidden bg-transparent">
                        <img src="${game.img}" class="w-full h-full object-contain transition-transform duration-1000 group-hover:scale-105" onerror="this.src='https://via.placeholder.com/400x400/111/fff?text=Meanbook'">
                    </div>
                    <div class="p-6 sm:p-8 flex flex-col flex-grow">
                        <div class="flex flex-col gap-2.5 mb-4 text-zinc-500 font-bold tracking-widest">
                            <div class="text-[14px] uppercase">
                                ภาษาเกม : ${game.lang} &nbsp; | &nbsp; คู่มือไทย : ${game.manual}
                            </div>
                            <div class="flex min-h-[40px] items-center">
                                ${typeDisplay}
                            </div>
                        </div>
                        <h3 class="text-lg font-bold mb-6 line-clamp-2 min-h-[3rem] leading-tight">${game.name}</h3>
                        
                        <div class="mt-auto">
                            <div class="grid grid-cols-2 gap-3 mb-6">
                                <div class="p-4 rounded-2xl bg-white/5 border border-white/5"><p class="text-[14px] text-zinc-500 uppercase mb-1.5 tracking-widest">ค่าเช่า/วัน</p><p class="text-lg font-bold text-white">${game.price || '0'}.-</p></div>
                                <div class="p-4 rounded-2xl bg-white/5 border border-white/5"><p class="text-[14px] text-zinc-500 uppercase mb-1.5 tracking-widest">มัดจำ</p><p class="text-lg font-bold text-white">${game.deposit || '0'}.-</p></div>
                            </div>
                            <a href="${isAvailable ? finalLink : '#'}" target="_blank" 
                               class="block w-full py-4 rounded-2xl font-black text-[20px] text-center tracking-[0.2em] transition-all ${buttonStyles}">
                                ${statusStr}
                            </a>
                        </div>
                    </div>
                </div>`;
            }).join('');
            lucide.createIcons();

            if (filteredGames.length > ITEMS_PER_PAGE) {
                if (isShowAll) {
                    paginationContainer.innerHTML = `
                        <button onclick="toggleShowAll()" class="px-8 py-4 rounded-2xl bg-white/10 border border-white/20 text-white font-bold tracking-widest uppercase text-sm transition-all hover:bg-white/20 flex items-center shadow-lg">
                            <i data-lucide="layout-grid" class="w-4 h-4 mr-3"></i> แสดงแบบแบ่งหน้า
                        </button>
                    `;
                } else {
                    paginationContainer.innerHTML = `
                        <div class="flex flex-col md:flex-row items-center gap-4 md:gap-6 bg-zinc-900/40 p-2 md:p-3 rounded-[2rem] border border-white/5">
                            <div class="flex items-center gap-2">
                                <button onclick="changePage(-1)" class="px-5 py-3 rounded-2xl bg-white/5 text-white font-bold tracking-widest uppercase text-sm transition-all hover:bg-white/10 disabled:opacity-30 disabled:cursor-not-allowed flex items-center" ${currentPage === 1 ? 'disabled' : ''}>
                                    <i data-lucide="chevron-left" class="w-4 h-4 mr-1"></i> ก่อนหน้า
                                </button>
                                <span class="text-zinc-400 font-bold tracking-widest text-sm px-2 whitespace-nowrap">
                                    ${currentPage} / ${totalPages}
                                </span>
                                <button onclick="changePage(1)" class="px-5 py-3 rounded-2xl bg-white/5 text-white font-bold tracking-widest uppercase text-sm transition-all hover:bg-white/10 disabled:opacity-30 disabled:cursor-not-allowed flex items-center" ${currentPage === totalPages ? 'disabled' : ''}>
                                    ถัดไป <i data-lucide="chevron-right" class="w-4 h-4 ml-1"></i>
                                </button>
                            </div>
                            <div class="hidden md:block w-px h-8 bg-white/10 mx-2"></div>
                            <button onclick="toggleShowAll()" class="px-6 py-3 rounded-2xl bg-white/10 text-white hover:bg-white/20 font-bold tracking-widest uppercase text-sm transition-all flex items-center w-full md:w-auto justify-center">
                                ดูทั้งหมด (${filteredGames.length})
                            </button>
                        </div>
                    `;
                }
                lucide.createIcons();
            } else {
                paginationContainer.innerHTML = '';
            }
        }

        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('statusFilter').addEventListener('change', applyFilters);
        window.onload = init;
    </script>
</body>
</html>